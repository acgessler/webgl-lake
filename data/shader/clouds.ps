#include <remote:mcore/shaders/core.psh>
#include <remote:mcore/shaders/lighting.psh>

uniform sampler2D texture;

uniform vec3 LIGHT_D0_DIR;

void main()
{
  vec3 nor = normalize(FetchNormal());

  // Slightly widen and offset the distribution of the dot product to make clouds
  // along or slightly across the day/night boundary still appear a bit lit.
  float lighting = clamp(dot(LIGHT_D0_DIR, nor) + 0.1, 0.0, 1.0);
  float sqLighting = sqrt(lighting);
  vec4 color = texture2D(texture, FetchTexCoord());
  gl_FragColor.rgb = vec3(1.0, 1.0, 1.0) * sqLighting * 0.8;
  gl_FragColor.a = color.r * sqLighting;
}

